const cheerio = require('cheerio');

exports.parse = (data) => {
    let cve = [];
    const $ = cheerio.load(data);

    $('.article-content > div > div')
        .children('h2').
        filter((i, elt) => $(elt).text() === 'Documentation')
        .next()
        .children('li')
        .filter((i, el) => $(el).text().startsWith('Référence CVE CVE-'))
        .each((i, el) => {
            const splittedCve = $(el).text().replace('Référence CVE ', '').split(/\s+/);
            cve.push({
                id: splittedCve[0].trim(),
                href: splittedCve[1].trim()
            });
        });

    return { cve: cve };
};