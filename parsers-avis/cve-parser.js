const cheerio = require('cheerio');

exports.parse = (data) => {
    let cve = [];
    const $ = cheerio.load(data);

    $('.article-content > div > div')
        .children('h2').
        filter((i, elt) => $(elt).text() === 'Documentation')
        .next()
        .children('li')
        .each((i, elt) => cve.push($(elt).text().replace('\n', '')));
    

    cve = cve.filter(e => e.startsWith('Référence CVE CVE-'))
    .map(e => e.replace('Référence CVE ', ''))
    .map(e => {
        const splittedCve = e.split(/\s+/);

        return { id: splittedCve[0], href: splittedCve[1] };
    });

    return { cve: cve };
};